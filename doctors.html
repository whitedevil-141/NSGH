<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>New Shafipur General Hospital</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
        <!-- Place favicon.ico in the root Internist, General Practitonery -->

		<!-- CSS here -->
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/animate.min.css">
        <link rel="stylesheet" href="css/magnific-popup.css">
        <link rel="stylesheet" href="fontawesome/css/all.min.css">
        <link rel="stylesheet" href="css/dripicons.css">
        <link rel="stylesheet" href="css/slick.css">
        <link rel="stylesheet" href="css/default.css">
        <link rel="stylesheet" href="css/meanmenu.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/responsive.css">
    </head>
    <body>
        <!-- header -->
        <header class="header-area">  
			<div class="header-top second-header d-none d-md-block">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-3 col-md-3 d-none d-lg-block">
                        </div>                       
                        <div class="col-lg-4 col-md-8 d-none  d-md-block">
                            <div class="header-cta">
                                <ul>                                   
                                    <li>
                                        <i class="icon dripicons-mail"></i>
                                        <span>nsfg@gmail.com</span>
                                    </li>
                                     <li>
                                        <i class="icon dripicons-phone"></i>
                                        <span>+8801711902062</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                         <div class="col-lg-5 col-md-3 d-none d-lg-block">
                             <div class="header-social text-right">
                            <span>
                                <a href="#" title="Facebook"><i class="fab fa-facebook"></i></a>
                                <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                                <a href="#" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>                               
                               </span>                    
                               <!--  /social media icon redux -->                               
                        </div>
                        </div>
                         
                    </div>
                </div>
            </div>		
            <div id="header-sticky" class="menu-area">
                <div class="container">
                    <div class="second-menu">
                        <div class="row align-items-center">
                            <div class="col-xl-2 col-lg-2">
                                <div class="logo">
                                    <a href="index.html"><img src="img/logo/logo.png" alt="logo"></a>
                                </div>
                            </div>
                            <div class="col-xl-8 col-lg-8">                               
                                <div class="main-menu text-right pr-15">
                                    <nav id="mobile-menu">
                                        <ul>
											<li><a href="index.html">Home</a></li>
                                            <li><a href="about.html">About Us</a></li>
                                            <li class="has-sub">
                                                <a href="services.html">Services</a>
                                            </li>
                                            <li class="has-sub"> 
                                                <a href="departments.html">Departments</a>
                                            </li>
                                                                                                                         
											<li class="has-sub"><a href="doctors.html">Doctors</a></li>
                                            <li><a href="machines.html">Machines</a></li>
											<li class="has-sub"> 
                                                <a href="gallery.html">Gallery</a>
                                            </li>               
                                        </ul>
                                    </nav>
                                </div>
                            </div>    
                             <div class="col-xl-2 col-lg-2 d-none d-lg-block">
                                 <button class="top-btn" onclick="openPopup()">Appointment <i class="fas fa-chevron-right"></i></button>

                                 
                            </div>
                             <div class="col-12">
                            <div class="mobile-menu"></div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- header-end -->
        <div class="section-title text-center pl-40 pr-40 pt-40 mb-0">
            <span>Our Doctors</span>
        </div>

        <!-- main-area -->
        <main>

            <div class="filter-box mb-4">
                <select id="doctorFilter">
                    <option value="all">All Departments</option>
                </select>
            </div>

            <div id="doctorsWrapper" style="position: relative; min-height: 400px;">
                <div id="loaderOverlay">
                    <div id="loader"></div>
                </div>
                <div id="doctorsContainer" class="row align-items-center">
                    <!-- Doctors will be injected here -->
                </div>
            </div>
            <!-- Doctor Quick View Modal -->
            <div id="doctorModal">
                <div class="modal-content">
                    <span id="modalClose" style="position:absolute; top:10px; right:15px; cursor:pointer; font-size:20px;">&times;</span>
                    <div id="modalBody"></div>
                </div>
            </div>
            


			
        </main>
        <!-- main-area-end -->
        <!-- footer -->
        <footer class="footer-bg footer-p" >
            <div class="overly"><img src="img/an-bg/footer-bg.png" alt="rest"></div>
            <div class="footer-top pb-30" style="background-color: #ECF1FA;">
                <div class="container">
                    <div class="row justify-content-between">
                        
                        <div class="col-xl-3 col-lg-3 col-sm-6">
                            <div class="footer-widget mb-30">
                                <div class="flog mb-35">
                                    <a href="#"><img src="img/logo/logo.png" alt="logo"></a>
                                </div>
                                <div class="footer-text mb-20">
                                    <p>Sed ut perspiciatis unde om is nerror sit voluptatem accustium dolorem tium totam rem aperam eaque ipsa quae ab illose
                                    inntore veritatis</p>
                                </div>
                                <div class="footer-social">
                                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                                    <a href="#"><i class="fab fa-twitter"></i></a>
                                    <a href="#"><i class="fab fa-instagram"></i></a>
                                    <a href="#"><i class="fab fa-google-plus-g"></i></a>
                                </div>
                            </div>
                        </div>
                        
                        
						<div class="col-xl-2 col-lg-2 col-sm-6">
                            <div class="footer-widget mb-30">
                                <div class="f-widget-title">
                                    <h5>Our Links</h5>
                                </div>
                                <div class="footer-link">
                                    <ul>                                        
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Partners</a></li>
										<li><a href="#"><i class="fas fa-chevron-right"></i> About Us</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Career</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Reviews</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Terms & Conditions</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Help</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-sm-6">
                            <div class="footer-widget mb-30">
                                <div class="f-widget-title">
                                    <h5>Other Links</h5>
                                </div>
                                <div class="footer-link">
                                    <ul>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Home</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> About Us</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Services</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Project</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Our Team</a></li>
                                        <li><a href="#"><i class="fas fa-chevron-right"></i> Latest Blog</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>  
                        <div class="col-xl-3 col-lg-3 col-sm-6">
                            <div class="footer-widget mb-30">
                                <div class="f-widget-title">
                                    <h5>Contact Us</h5>
                                </div>
                                <div class="footer-link">
                                    <div class="f-contact">
                                    <ul>
                                    <li>
                                        <i class="icon dripicons-phone"></i>
                                        <span>1800-121-3637<br>+91 555 234-8765</span>
                                    </li>
                                    <li>
                                        <i class="icon dripicons-mail"></i>
                                         <span><a href="mailto:info@example.com">info@example.com</a><br><a href="mailto:sale@example.com">sale@example.com</a></span>
                                    </li>
                                    <li>
                                      <i class="fal fa-map-marker-alt"></i>
                                         <span>380 St Kilda Road, Melbourne<br>VIC 3004, Australia</span>
                                    </li>
                                </ul>
                                    
                                    </div>
                                   
                                    
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            <div class="copyright-wrap">
                <div class="container">
                    <div class="row">
                        <div class="col-12">
                            <div class="copyright-text text-center">
                                <p>&copy; 2020 Mecare  All design Zcube.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- footer-end -->

        <!-- Modal Structure -->
        <div id="appointmentModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-box" role="document" tabindex="-1">
                <button class="modal-close" aria-label="Close modal" onclick="closePopup()">&times;</button>
                <h2 id="modalTitle">Get Expert Care</h2>
                <form id="appointmentForm">
                <input type="text" placeholder="Full Name" required autocomplete="name" />
                <!-- <input type="email" placeholder="Email Address" required autocomplete="email" /> -->
                <input type="tel" placeholder="Phone Number" required autocomplete="tel" />
                <input type="date" required />
                <textarea placeholder="Reason for appointment" required></textarea>
                <button type="submit" class="submit-btn">Submit</button>
                </form>
            </div>
        </div>

		<!-- JS here -->
        <script src="js/vendor/modernizr-3.5.0.min.js"></script>
        <script src="js/vendor/jquery-1.12.4.min.js"></script>
        <script src="js/popper.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/one-page-nav-min.js"></script>
        <script src="js/jquery.meanmenu.min.js"></script>
        <script src="js/slick.min.js"></script>
        <script src="js/ajax-form.js"></script>
        <script src="js/paroller.js"></script>
        <script src="js/wow.min.js"></script>
        <script src="js/js_isotope.pkgd.min.js"></script>
        <script src="js/imagesloaded.min.js"></script>
        <script src="js/parallax.min.js"></script>
        <script src="js/jquery.waypoints.min.js"></script>
        <script src="js/jquery.counterup.min.js"></script>
        <script src="js/jquery.scrollUp.min.js"></script>
        <script src="js/parallax-scroll.js"></script>
        <script src="js/jquery.magnific-popup.min.js"></script>
        <script src="js/element-in-view.js"></script>
        <script src="js/main.js"></script>

        <script>
            const perPage = 8;
            let currentPage = 1;
            let currentCategory = "all";
            let sampleDepartments = [];
            let sampleDoctors = [];

            const container = document.getElementById("doctorsContainer");

            // Fetch data from API
            async function loadData() {
                try {
                    const res = await fetch('/public/doctors/data');

                if (!res.ok) {
                    // Handle non-200 responses gracefully
                    const text = await res.text();
                    console.error(`Error fetching doctors: ${res.status} ${res.statusText}`, text);
                    alert(`Failed to fetch doctors: ${res.status} ${res.statusText}. Please try again after few minutes`);
                    return;
                }
                data = await res.json();
                sampleDoctors = data.doctors
                
                sampleDepartments = data.categories;

                loadDepartments();
                loadDoctors();
                } catch (error) {
                    console.error("Error loading data:", error);
                }
            }


            /* ===================== Load Departments ===================== */
            function loadDepartments() {
                const select = document.getElementById("doctorFilter");
                select.innerHTML = `<option value="all">All Departments</option>`;
                sampleDepartments.forEach(dep => {
                    const option = document.createElement("option");
                    option.value = dep;
                    option.textContent = dep;
                    select.appendChild(option);
                });
            }

            /* ===================== Load Doctors ===================== */
            function loadDoctors(category = "all", page = 1) {
                currentCategory = category;
                currentPage = page;

                container.style.opacity = 0;

                setTimeout(() => {
                    container.innerHTML = "";
                    const filtered = sampleDoctors.filter(doc => category === "all" || doc.category === category);
                    const start = (page - 1) * perPage;
                    const paginatedDoctors = filtered.slice(start, start + perPage);

                    paginatedDoctors.forEach(doc => {
                    container.innerHTML += `
                        <div class="col-xl-3 col-lg-3 col-md-6 doctor-card">
                        <div class="single-team mb-30" style="min-height: 380px;" data-id="${doc.id}">
                            <div class="team-thumb">
                            <img src="${doc.photo_url}" alt="${doc.name}" loading="lazy">
                            </div>
                            <div class="team-info">
                            <h4>${doc.name}</h4>
                            <span>${doc.specialization}</span>
                            </div>
                        </div>
                        </div>`;
                    });
                    container.style.opacity = 1;
                    renderPagination(filtered.length, page);
                }, 200);
            }

            /* ===================== Pagination ===================== */
            function renderPagination(totalDoctors, page) {
                const oldPagination = document.getElementById("pagination");
                if (oldPagination) oldPagination.remove();

                const totalPages = Math.ceil(totalDoctors / perPage);
                if (totalPages <= 1) return;

                const pagination = document.createElement("ul");
                pagination.id = "pagination";
                pagination.className = "pagination justify-content-center mt-4";

                for (let i = 1; i <= totalPages; i++) {
                    const li = document.createElement("li");
                    li.className = "page-item " + (i === page ? "active" : "");

                    const a = document.createElement("a");
                    a.className = "page-link";
                    a.href = "#";
                    a.textContent = i;
                    a.addEventListener("click", e => {
                        e.preventDefault();
                        loadDoctors(currentCategory, i);
                    });

                    li.appendChild(a);
                    pagination.appendChild(li);
                }

                container.parentNode.appendChild(pagination);
            }

            /* ===================== Filter Listener ===================== */
            document.getElementById("doctorFilter").addEventListener("change", e => loadDoctors(e.target.value, 1));

            /* ===================== Initialize ===================== */
            loadData();
        </script>

        <script>
            const modal = document.getElementById("doctorModal");
            const modalBody = document.getElementById("modalBody");
            const modalClose = document.getElementById("modalClose");

            // Delegate click on doctor cards
            container.addEventListener("click", e => {
                const card = e.target.closest(".single-team");
                if (!card) return;

                const docId = parseInt(card.dataset.id);
                const doc = sampleDoctors.find(d => d.id === docId);
                if (!doc) return;

                modalBody.innerHTML = `
                    <div style="text-align:center; max-width:300px; margin:auto; font-family:Arial, sans-serif; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); border-radius:15px;">
                        <img src="${doc.photo_url}" alt="${doc.name}" 
                            style="width:150px; height:150px; border-radius:50%; object-fit:cover; margin-bottom:15px;">

                        <h3 style="margin-bottom:10px; font-size:1.4em; color:#333;">${doc.name}</h3>
                        <h5 style="margin-bottom:15px; font-size:1.1em; color:#777;">${doc.description}</h5>
                        <p style="margin-bottom:15px; font-size:0.95em; color:#555; line-height:1.4; ">
                            
                            <strong>Phone:</strong> ${doc.phone} <br> 
                            <strong>Specialization:</strong> ${doc.specialization}<br>
                            <strong>Experience:</strong> ${doc.experience_yr} years
                        </p>
                        <a href="tel:${doc.phone}" 
                            style="display:inline-block; margin-top:10px; padding:10px 20px; background-color:#28a745; color:white; text-decoration:none; font-weight:bold; border-radius:8px; transition:0.3s;">
                            Call Now
                        </a>
                    </div>

                `;

                modal.classList.add("show");
            });

            // Close modal
            modalClose.addEventListener("click", () => modal.classList.remove("show"));
            window.addEventListener("click", e => { if(e.target === modal) modal.classList.remove("show"); });


        </script>
    </body>
</html>